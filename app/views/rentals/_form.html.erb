<%= form_for @rental, html: { multipart: true } do |f| %>
  <% if @rental.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@rental.errors.count, "error") %> prohibited this rental from being saved:</h2>

      <ul>
      <% @rental.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
	<div class="field">
    <%= f.label :title %><br>
    <%= f.text_field :title %>
  </div>
	<div class="field">
    <%= f.label :description %><br>
    <%= f.text_area :description, :size => "60" %>
  </div>
  <div class="field">
    <%= f.label :price %><br>
    <%= f.text_field :price %>
  </div>
  <div class="field">
    <%= f.label :property_type %><br>
    <%= f.text_field :property_type %>
  </div>
  <div class="field">
    <%= f.label :no_of_bedrooms %><br>
    <%= f.number_field :no_of_bedrooms %>
  </div>
  <div class="field">
    <%= f.label :bedroom_type %><br>
    <%= f.text_field :bedroom_type %>
  </div>
  <div class="field">
    <%= f.label :no_of_bathrooms %><br>
    <%= f.number_field :no_of_bathrooms %>
  </div>
  <div class="field">
    <%= f.label :bathroom_type %><br>
    <%= f.text_field :bathroom_type %>
  </div>
  <div class="field">
    <%= f.label :deposit %><br>
    <%= f.text_field :deposit %>
  </div>
  <div class="field">
    <%= f.label :maximum_no_of_people_per_room %><br>
    <%= f.text_field :maximum_no_of_people_per_room %>
  </div>
  <div class="field">
    <%= f.label :address %><br>
    <%= f.text_field :address %>
  </div>
  <div class="field">
    <%= f.label :contact_number %><br>
    <%= f.text_field :contact_number %>
  </div>
  <div class="field">
    <%= f.label :owner %><br>
    <%= f.text_field :owner %>
  </div>
	<div class="field">
    <%= f.label :image %><br>
    <%= f.file_field :image %>
  </div>
	<div>
		<%= f.hidden_field :latitude, :value=>@rental.latitude %>
		<%= f.hidden_field :longitude, :value=>@rental.longitude %>
	</div>

	<div style='width: 800px;'>
  	<div id="map" style='width: 800px; height: 400px;'></div>
	</div>
	<div class="actions">
    <%= f.submit %>
  </div>
<% end %>

<script src="//maps.google.com/maps/api/js?key=AIzaSyBNQxaG0j6on6nJNF_JDlNszNGO3-8lN50"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->

<script type='text/javascript'>

	var lt = $('#rental_latitude').val().length>0? parseFloat($('#rental_latitude').val()):11.00;
	var ln = $('#rental_longitude').val().length>0? parseFloat($('#rental_longitude').val()):125.00;
	console.log(lt + " & " +ln);

	var map = new google.maps.Map(document.getElementById('map'),{
		center:{
			lat: lt,	
			lng: ln
		},
		zoom:15		
	});

	var marker = new google.maps.Marker({
		position:{
			lat: lt,
			lng: ln
		},
		map: map,
		draggable: true	
	});

	google.maps.event.addListener(marker, 'dragend', function () {
		var lat = marker.getPosition().lat();
		var lng = marker.getPosition().lng();

		$('#rental_latitude').val(lat);
		$('#rental_longitude').val(lng);

	});		
</script>

